---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

# textgrid

## installation

First install the devtools package, then install from this repository.

```{r, eval = FALSE}
devtools::install_github("tjmahr/textgrid")
```

## usage

Load a textgrid. 

```{r}
library("textgrid")
textgrid <- TextGrid("tests/testthat/assets/alignment.TextGrid")
textgrid
```

Extract a tier as a dataframe

```{r}
data.frame(textgrid[["word"]])
```

Convert textgrid into a dataframe. 

```{r}
data.frame(textgrid)
```



### textgrid validation

The package provides functions that can be used to validate assumptions about a
textgrid. 

These can be used on their own to get TRUE/FALSE values, or used with 
[assertthat](https://github.com/hadley/assertthat) functions so that failures
return informative messages.

#### has_tiers

Test that a textgrid contains certain tiers:

```{r}
# Plain use
has_tiers(textgrid, "word")
has_tiers(textgrid, "null")

library("assertthat")
# validate_that returns TRUE or a string containing a failure message. It's used
# to demonstrate assertions.
validate_that(has_tiers(textgrid, "word"))
validate_that(has_tiers(textgrid, "null"))
validate_that(has_tiers(textgrid, c("null1", NA)))

# assert_that returns TRUE or an error. This form is used inside of functions or
# scripts to make sure assumptions hold before executing additional code. I have
# to wrap this example with `try` so that the failure here does not crash the
# generation of this report.
try(assert_that(has_tiers(textgrid, "null")))
#> Error: Tier not found in 'alignment.TextGrid': 'null'
```

#### is_interval_tier, is_text_tier

Test that a given tier is an interval tier or a text tier

```{r}
mixed_tiers <- TextGrid("tests/testthat/assets/tones.TextGrid")
mixed_tiers

is_text_tier(mixed_tiers, "b")
is_text_tier(mixed_tiers, "m")

is_interval_tier(mixed_tiers, "m")
is_interval_tier(mixed_tiers, "b")

# Custom failure messages
validate_that(is_interval_tier(mixed_tiers, c("b")))
validate_that(is_text_tier(mixed_tiers, c("m", "j")))

# has_tiers() is a prerequisite for these functions
validate_that(is_interval_tier(mixed_tiers, NA))

```

